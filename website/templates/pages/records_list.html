{% extends 'pages/base.html' %}

{% load ui_icons %}

{% block title %}Records · Admin{% endblock %}

{% block content %}
  {% with primary_button="inline-flex items-center gap-2 rounded-full bg-sky-500 px-5 py-2.5 text-sm font-semibold text-white shadow-lg shadow-sky-500/40 transition hover:bg-sky-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-sky-200" muted_button="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white/80 px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:border-slate-300 hover:bg-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-400" danger_button="inline-flex items-center gap-2 rounded-full border border-rose-200 bg-rose-50 px-4 py-2 text-sm font-semibold text-rose-600 transition hover:bg-rose-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-rose-300" %}
  <section class="space-y-12 pb-16">
    <header class="relative overflow-hidden rounded-3xl bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-900 text-slate-100 shadow-[0_70px_120px_-60px_rgba(29,78,216,0.55)]">
      <div class="pointer-events-none absolute inset-0">
        <div class="absolute -left-24 -top-24 h-72 w-72 rounded-full bg-cyan-400/30 blur-3xl"></div>
        <div class="absolute bottom-12 right-0 h-48 w-48 rounded-full bg-violet-400/20 blur-3xl"></div>
        <div class="absolute inset-x-24 bottom-[-3rem] h-32 rounded-full bg-white/10 blur-2xl"></div>
      </div>
      <div class="relative grid gap-12 p-8 sm:p-10 lg:grid-cols-[minmax(0,1.25fr)_minmax(0,0.85fr)]">
        <div class="space-y-8">
          <div class="flex flex-wrap items-center gap-3 text-sm text-white/70">
            <span class="inline-flex items-center gap-2 rounded-full border border-white/15 bg-white/10 px-3 py-1 text-[0.7rem] font-semibold uppercase tracking-[0.22em]">
              {% icon 'satellite' classes='h-4 w-4' %} Mission control
            </span>
            <span class="inline-flex items-center gap-2 text-xs font-medium uppercase tracking-[0.18em] text-white/60">
              {% icon 'sparkles' classes='h-4 w-4' %} Live workspace
            </span>
          </div>
          <div class="space-y-4">
            <h1 class="text-3xl font-semibold leading-tight text-white sm:text-4xl lg:text-5xl">
              Hi {{ request.user.first_name|default:request.user.username }}, let's keep momentum going.
            </h1>
            <p class="max-w-2xl text-base text-slate-200/85 sm:text-lg">
              Track progress, surface priorities, and take action without leaving this page.
            </p>
          </div>
          <div class="flex flex-wrap items-center gap-3">
            <a href="{% url 'record_create' %}" class="{{ primary_button }}">{% icon 'plus' classes='h-4 w-4' %} New record</a>
            <a href="{% url 'dashboard' %}" class="inline-flex items-center gap-2 rounded-full border border-white/20 bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/50">{% icon 'gauge' classes='h-4 w-4' %} Overview</a>
            <a href="{% url 'logout' %}" class="inline-flex items-center gap-2 rounded-full border border-transparent px-4 py-2 text-sm font-semibold text-white/80 transition hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/40">{% icon 'logout' classes='h-4 w-4' %} Sign out</a>
          </div>
        </div>
        <div class="grid content-start gap-4 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2">
          <div class="group rounded-2xl border border-white/15 bg-white/10 p-5 shadow-xl shadow-black/25 backdrop-blur transition hover:border-white/25 hover:bg-white/15">
            <div class="flex items-center justify-between text-xs font-semibold uppercase tracking-[0.28em] text-white/60">
              Total records
              <span class="rounded-full bg-white/10 px-2 py-[0.15rem] text-[0.65rem] font-semibold text-white/80">All time</span>
            </div>
            <p class="mt-3 text-4xl font-semibold text-white">{{ total_records }}</p>
            <p class="text-sm text-white/60">Across every workspace</p>
          </div>
          <div class="group rounded-2xl border border-white/15 bg-white/10 p-5 shadow-xl shadow-black/25 backdrop-blur transition hover:border-white/25 hover:bg-white/15">
            <div class="flex items-center justify-between text-xs font-semibold uppercase tracking-[0.28em] text-white/60">
              Active view
              <span class="rounded-full bg-sky-500/30 px-2 py-[0.15rem] text-[0.65rem] font-semibold text-white/90">Live</span>
            </div>
            <p class="mt-3 text-4xl font-semibold text-white">{{ matches }}</p>
            <p class="text-sm text-white/60">{{ matches|pluralize:'record,records' }} in scope</p>
          </div>
          <div class="group rounded-2xl border border-white/15 bg-white/10 p-5 shadow-xl shadow-black/25 backdrop-blur transition hover:border-white/25 hover:bg-white/15">
            <div class="flex items-center justify-between text-xs font-semibold uppercase tracking-[0.28em] text-white/60">
              Filter status
              <span class="rounded-full bg-white/10 px-2 py-[0.15rem] text-[0.65rem] font-semibold text-white/80">Instant</span>
            </div>
            <p class="mt-3 text-2xl font-semibold text-white">{% if query %}{{ query }}{% else %}No filter applied{% endif %}</p>
            <p class="text-sm text-white/60">Search updates as you type</p>
          </div>
        </div>
      </div>
    </header>

    <div class="grid gap-10 lg:grid-cols-[minmax(260px,320px),1fr]">
      <aside class="space-y-6">
        <form method="get" class="rounded-3xl border border-slate-200/70 bg-white/85 p-6 shadow-xl shadow-slate-900/10 backdrop-blur">
          <span class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-400">Quick search</span>
          <label class="mt-3 flex items-center gap-3 rounded-2xl border border-transparent bg-slate-100/70 px-4 py-3 text-slate-500 transition focus-within:border-sky-200 focus-within:bg-white">
            {% icon 'search' classes='h-4 w-4 text-slate-400' %}
            <input type="search" name="q" value="{{ query }}" placeholder="Search by title, description, or owner" aria-label="Search records" class="flex-1 border-0 bg-transparent text-sm text-slate-700 placeholder:text-slate-400 focus:outline-none">
          </label>
          <div class="mt-4 flex flex-wrap gap-3">
            <button type="submit" class="{{ primary_button }}">{% icon 'search' classes='h-4 w-4' %} Search</button>
            {% if query %}
            <a href="{% url 'records_list' %}" class="{{ muted_button }}">{% icon 'x' classes='h-4 w-4' %} Clear</a>
            {% endif %}
          </div>
          <div class="mt-6 grid gap-3 text-xs text-slate-500">
            <span class="font-semibold uppercase tracking-[0.18em] text-slate-400">Recent filters</span>
            <div class="flex flex-wrap gap-2">
              <span class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-[0.7rem] font-medium text-slate-600">{% icon 'hash' classes='h-4 w-4' %} status:open</span>
              <span class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-[0.7rem] font-medium text-slate-600">{% icon 'user' classes='h-4 w-4' %} owner:me</span>
              <span class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-[0.7rem] font-medium text-slate-600">{% icon 'fire' classes='h-4 w-4' %} priority</span>
            </div>
          </div>
        </form>

        <div class="overflow-hidden rounded-3xl border border-sky-200/70 bg-gradient-to-br from-sky-50 via-white to-indigo-50 p-6 text-slate-600 shadow-lg shadow-sky-500/10">
          <div class="inline-flex items-center gap-2 rounded-full bg-sky-100 px-3 py-1 text-xs font-semibold uppercase tracking-[0.2em] text-sky-700">
            {% icon 'lightbulb' classes='h-4 w-4' %} Pro tip
          </div>
          <p class="mt-4 text-sm leading-relaxed">Combine keywords with owner names to narrow results. Save frequently used searches as browser bookmarks for fast recall.</p>
          <button type="button" class="mt-5 inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.18em] text-sky-600 transition hover:text-sky-500">
            {% icon 'floppy' classes='h-4 w-4' %} Save search preset
          </button>
        </div>
      </aside>

      <div class="space-y-6">
        <div class="flex flex-wrap items-start justify-between gap-4">
          <div>
            <h2 class="text-xl font-semibold text-slate-900">Records</h2>
            <p class="max-w-xl text-sm text-slate-500">Sorted by most recent activity. Jump in to review, update, or archive.</p>
          </div>
          <div class="flex flex-wrap gap-2">
            <span class="inline-flex items-center gap-2 rounded-full bg-sky-100 px-3 py-1 text-xs font-semibold text-sky-700">{% icon 'clock-refresh' classes='h-4 w-4' %} Updated today</span>
            <span class="inline-flex items-center gap-2 rounded-full bg-violet-100 px-3 py-1 text-xs font-semibold text-violet-700">{% icon 'stack' classes='h-4 w-4' %} Organized grid</span>
          </div>
        </div>

        <div class="grid gap-6 md:grid-cols-2 xl:grid-cols-3">
          {% for r in records %}
          <article class="group relative overflow-hidden rounded-2xl border border-slate-200/60 bg-white/95 p-6 shadow-xl shadow-slate-900/10 transition duration-200 hover:-translate-y-1 hover:border-sky-200 hover:shadow-2xl">
            <div class="pointer-events-none absolute -right-14 top-6 h-32 w-32 rounded-full bg-sky-100/70 blur-2xl transition duration-200 group-hover:scale-110"></div>
            <div class="pointer-events-none absolute -left-20 bottom-[-3rem] h-32 w-32 rounded-full bg-violet-100/70 blur-3xl transition duration-200 group-hover:scale-110"></div>
            <header class="relative z-10 flex items-center justify-between gap-4">
              <div class="space-y-2">
                <span class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-[0.7rem] font-semibold uppercase tracking-[0.22em] text-slate-500">{% icon 'stack' classes='h-4 w-4' %} Record</span>
                <h3 class="text-lg font-semibold text-slate-900"><a href="{% url 'record_detail' r.pk %}" class="transition hover:text-sky-600">{{ r.title }}</a></h3>
              </div>
              <span class="inline-flex items-center gap-2 rounded-full bg-sky-100 px-3 py-1 text-xs font-semibold text-sky-700">{% icon 'user' classes='h-4 w-4' %} {{ r.created_by|default:'Unassigned' }}</span>
            </header>
            <p class="relative z-10 mt-3 text-sm leading-relaxed text-slate-600">{{ r.description|default:'No description added yet.'|truncatewords:24 }}</p>
            <dl class="relative z-10 mt-6 grid gap-4 text-sm text-slate-500 sm:grid-cols-2">
              <div class="space-y-1">
                <dt class="flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.18em] text-slate-400">{% icon 'calendar' classes='h-4 w-4' %} Created</dt>
                <dd class="font-medium text-slate-700">{{ r.created_at|date:'M j, Y · H:i' }}</dd>
              </div>
              <div class="space-y-1">
                <dt class="flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.18em] text-slate-400">{% icon 'clock' classes='h-4 w-4' %} Updated</dt>
                <dd class="font-medium text-slate-700">{{ r.updated_at|date:'M j, Y · H:i' }}</dd>
              </div>
            </dl>
            <div class="relative z-10 mt-6 flex flex-wrap gap-3">
              <a href="{% url 'record_detail' r.pk %}" class="{{ muted_button }}">{% icon 'external' classes='h-4 w-4' %} View</a>
              <a href="{% url 'record_update' r.pk %}" class="inline-flex items-center gap-2 rounded-full border border-sky-200 bg-white px-4 py-2 text-sm font-semibold text-sky-600 transition hover:border-sky-300 hover:text-sky-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-sky-300">{% icon 'pen' classes='h-4 w-4' %} Edit</a>
              <a href="{% url 'record_delete' r.pk %}?next={% url 'records_list' %}" class="{{ danger_button }}">{% icon 'trash' classes='h-4 w-4' %} Delete</a>
            </div>
          </article>
          {% empty %}
          <div class="col-span-full overflow-hidden rounded-3xl border border-dashed border-slate-200 bg-gradient-to-br from-white via-slate-50 to-slate-100 p-12 text-center shadow-inner">
            <div class="mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-slate-200/60 text-slate-500">
              {% icon 'folder' classes='h-9 w-9' %}
            </div>
            {% if query %}
              <h3 class="mt-6 text-2xl font-semibold text-slate-900">No results</h3>
              <p class="mt-2 text-sm text-slate-600">No records match “{{ query }}”. Try widening your search.</p>
              <a href="{% url 'records_list' %}" class="inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-4 py-2 text-sm font-semibold text-slate-600 transition hover:bg-slate-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-300">
                {% icon 'refresh' classes='h-4 w-4' %} Reset search
              </a>
            {% else %}
              <h3 class="mt-6 text-2xl font-semibold text-slate-900">Let’s create your first record</h3>
              <p class="mt-2 text-sm text-slate-600">You haven’t added any records yet. Start by creating one below.</p>
              <a href="{% url 'record_create' %}" class="{{ primary_button }} text-base">{% icon 'plus' classes='h-4 w-4' %} Create the first record</a>
            {% endif %}
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </section>
  {% endwith %}
{% endblock %}
